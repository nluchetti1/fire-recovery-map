<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fire Weather Recovery Viewer</title>
    <style>
        body { font-family: sans-serif; background: #222; color: #eee; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        h2 { margin: 10px 0; }
        .controls { margin-bottom: 20px; display: flex; gap: 10px; }
        button { padding: 10px 20px; cursor: pointer; background: #444; color: #fff; border: 1px solid #666; font-size: 16px; }
        button:hover { background: #666; }
        button.active { background: #007bff; border-color: #0056b3; }
        #map-container { width: 100%; max-width: 1000px; border: 1px solid #444; background: #000; }
        img { width: 100%; height: auto; display: block; }
        .timeline { display: flex; gap: 2px; margin-top: 10px; flex-wrap: wrap; justify-content: center; max-width: 1000px; }
        .time-box { width: 40px; padding: 5px; background: #333; text-align: center; cursor: pointer; font-size: 12px; }
        .time-box:hover, .time-box.active { background: #007bff; }
    </style>
</head>
<body>

    <h2>Nighttime Fuel Recovery</h2>
    <div id="status">Run: Loading...</div>

    <div id="map-container">
        <img id="forecast-img" src="images/recovery_f01.png" onerror="this.src=''; this.alt='Image not found (Script may be running)'">
    </div>

    <div class="controls">
        <button onclick="changeFrame(-1)">&#8592; Prev</button>
        <button onclick="togglePlay()" id="playBtn">Play</button>
        <button onclick="changeFrame(1)">Next &#8594;</button>
    </div>

    <div class="timeline" id="timeline"></div>

<script>
    const totalHours = 18; 
    let currentHour = 1;
    let isPlaying = false;
    let timer;

    // Build Timeline
    const timeline = document.getElementById('timeline');
    for(let i=1; i<=totalHours; i++) {
        let div = document.createElement('div');
        div.className = 'time-box';
        div.innerText = 'f'+ (i < 10 ? '0'+i : i);
        div.onclick = () => setFrame(i);
        div.id = 'box-'+i;
        timeline.appendChild(div);
    }

    function setFrame(h) {
        currentHour = h;
        if(currentHour > totalHours) currentHour = 1;
        if(currentHour < 1) currentHour = totalHours;

        const fStr = currentHour < 10 ? '0'+currentHour : currentHour;
        document.getElementById('forecast-img').src = `images/recovery_f${fStr}.png`;

        // Update Timeline UI
        document.querySelectorAll('.time-box').forEach(b => b.classList.remove('active'));
        document.getElementById('box-'+currentHour).classList.add('active');
    }

    function changeFrame(dir) {
        setFrame(currentHour + dir);
    }

    function togglePlay() {
        isPlaying = !isPlaying;
        document.getElementById('playBtn').innerText = isPlaying ? "Pause" : "Play";
        if(isPlaying) {
            timer = setInterval(() => changeFrame(1), 500);
        } else {
            clearInterval(timer);
        }
    }

    // Initialize
    setFrame(1);
    
    // Keyboard nav
    document.addEventListener('keydown', (e) => {
        if(e.key === "ArrowLeft") changeFrame(-1);
        if(e.key === "ArrowRight") changeFrame(1);
    });
</script>

</body>
</html>
